# Shell
Written by Ivan Galakhov, pd 5

> "It's nice" - Sam Rosenstrauch

> "Unapologetically functional" - Gilvir Gill

## Features
* Forks child processes and runs commands with any number of arguments or spaces
* Separates multiple commands through ";". Ignores empty commands as well.
* input/output/error redirection with <, >, >>, 2>, and 2>>
  Big thanks to Simon Bernes for showing me how to do this correctly
* pipes (multiple pipes work as well)
* Fun colors!

## Attempted
* I didn't attempt to do anything because I was trying to get multiple redirection
and multiple pipes to actually work properly, but I did try looking into how
one would implement some kind of command history and found that it's very hard to
get that to properly work on all operating systems.

## Bugs
* Sometimes, running a command causes a "pointer being freed was not allocated" error. I have only gotten this once or twice and I don't really know how to fix it or where it comes from.
* Having a really large number of redirects might break something eventually.
* There (might) be memory leaks.

## Function headers

### argparser.c/argparser.h
```c
char * get_current_command (char * , int * );
```
*Inputs*: A pointer to the string into which the user input will be written && a
pointer to the current maximum command size.

*Returns*: Pointer to the command string. Also updates maximum command size if the
user input exceeded it.

*Description*: This function is used to get the current user input. It will read the
input from STDIN character by character and will write it into a character array,
also returning the pointer to that array. If the size of the array is too small,
it will update the maximum command size.


```c
void clear_multiple_spaces (char * );
```
*Inputs*: A pointer to a string whose spaces need to be cleared.

*Returns*: Nothing!

*Description*: Takes in a pointer to a string, and replaces all instances of
multiple spaces with a single space. Since the size of the resultant string will
always be either equal or smaller than the size of the input string, everything
is done in place. A null terminator is written.


```c
void trimstr (char * );
```
*Inputs*: A pointer to a string that needs to be trimmed.

*Returns*: Nothing!

*Description*: Takes in a pointer to a string, and removes spaces from the
beginning and the end. Since the size of the resultant string will
always be either equal or smaller than the size of the input string, everything
is done in place. A null terminator is written.


```c
char ** split_line (char * , char );
```
*Inputs*: A pointer to the string that need to be split, and the character by
which it should be split.

*Returns*: A 2D NULL terminated array of the split string.

*Description*: Takes in a string and splits it by a certain character. All the
strings resulted from this split are placed into a NULL terminated 2D array. The
pointer to this array is returned. This function is used to parse commands from
the user.


```c
char *** build_command_array (char * );
```
*Inputs*: A pointer to the string from which the command array is built.

*Returns*: A 3D NULL terminated array.

*Description*: First splits the command by ';', and then split every resultant
string by '|'. All this information is written into a 3D array. This array is
later used by the executor to run commands.


```c
void free_command_array (char *** );
```
*Inputs*: A 3D NULL terminated array.

*Returns*: Nothing!

*Description*: Takes in an array generated by build_command_array, and frees
every pointer within it.


### executor.c/executor.h
```c
void execute_command_array (char *** );
```
*Inputs*: A 3D NULL terminated array generated by build_command_array.

*Returns*: Nothing!

*Description*: Takes in an array generated by build_command_array, and executes
every command within it. This takes care of all redirections and pipes as well.


```c
void setup_redirect (int, int, char *, int *);
```
*Inputs*: What is being redirected, how it is being redirected, the name of the file
that is being redirected, and a pointer to the file descriptor.

*Returns*: Nothing!

*Description*: Sets up redirection for one of the standard inputs or outputs into
some file. Updates the file descriptor of the file.


```c
void dummy_signal_handler (int);
```
*Inputs*: Signal number.

*Returns*: Nothing!

*Description*: This is a useless function that is used to disable the signal
handler for SIGINT.


### myshell.c
```c
void new_line();
```
*Inputs*: Nothing!

*Returns* Nothing!

*Description*: Prints out a new line of the shell.


```c
static void sig_handler(int num);
```
*Inputs*: Signal number.

*Returns* Nothing!

*Description*: Used to handle SIGINT. Prints out a new line and doesn't terminate
the shell.


```c
int main();
```
*Inputs*: Nothing!

*Returns* Exit status.

*Description*: Main function. Handles everything.
